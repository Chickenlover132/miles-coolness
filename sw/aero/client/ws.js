var __aero$websockets=[];const valid_chars="!#$%&'*+-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz|~",reserved_chars="%";function encode_protocol(e){e=e.toString();let o="";for(let t=0;t<e.length;t++){const r=e[t];if(valid_chars.includes(r)&&!"%".includes(r))o+=r;else{o+="%"+r.charCodeAt().toString(16).padStart(2,0)}}return o}function decode_protocol(e){if("string"!=typeof e)throw new TypeError("protocol must be a string");let o="";for(let t=0;t<e.length;t++){const r=e[t];if("%"==r){const r=parseInt(e.slice(t+1,t+3),16);o+=String.fromCharCode(r),t+=2}else o+=r}return o}window.WebSocket=new Proxy(window.WebSocket,{construct(e,[o,t]){const r=new URL(o);var n=Math.floor(899999*Math.random()+1e5);__aero$websockets.push([n,r]);const c={remote:{host:r.hostname,port:r.port||("wss:"===r.protocol?"443":"80"),path:r.pathname+r.search,protocol:r.protocol},headers:{Host:r.host,Origin:__aero$meta.origin,Pragma:"no-cache","Cache-Control":"no-cache",Upgrade:"websocket",Connection:"Upgrade"},forward_headers:["accept-encoding","accept-language","sec-websocket-extensions","sec-websocket-key","sec-websocket-version"]};var s=Reflect.construct(e,[window.location.origin.replace("http","ws")+"/bare/v1/?id="+n,["bare",encode_protocol(JSON.stringify(c))]]),a=function(e){__aero$websockets.splice(__aero$websockets.findIndex((e=>e[0]==n)),1)};return s.addEventListener("close",a),s.addEventListener("error",a),s}});var wsUrl=Object.getOwnPropertyDescriptor(window.WebSocket.prototype,"url");Object.defineProperty(window.WebSocket.prototype,"url",{get(){var e=wsUrl.get.call(this);try{var o=new URLSearchParams(new URL(e).search).get("id");return o?String(__aero$websockets.find((e=>e[0]==parseInt(o)))[1]):e}catch(o){return e}},set:()=>!1});